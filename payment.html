<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Spending by Payment</title>
        <link rel="stylesheet" href="styles-vis.css">
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;400;700&display=swap" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    </head>
    <body>
        <div class="header">
            <div class="h1-img">
                <img src="images/icon.png">
                <h1>Prince George's County Spending</h1>
            </div>
            <div class="topnav">
                <a href="index.html">Home</a>
                <div class="dropdown">
                    <a class="active" href="#Spending">Spending</a>
                    <div class="dropdown-content">
                        <a href="agency.html">Agency</a>
                        <a href="payment.html">Payment</a>
                    </div>
                </div>
                <a href="about.html">About</a>
                <a href="documentation.html">Documentation</a>
            </div>
        </div>
        <div class ="container">
            <div class="wrapper">
                <h2>Spending by Payment</h2>
                <div class="chartWrapper" style="height: 500px; overflow-x:auto;position:relative;">
                    <canvas id="bar-chart" width="700" height="3000">
                        <img src="https://i.imgur.com/fXUIBfi.gif" alt="Chart will Render Here..."/>
                    </canvas>
                </div>
                <div class="about">
                    <p>From the visual, we can see that payments for contribution to the Board of Education took up most of the spending in 2019, followed by payments for construction. You can mouse over specific payments to see their exact amount.</p>
                </div>
            </div>
        </div>
        <script>
            fetch('/payment')
            .then((data) => data.json())
            .then((data) => {
                console.log(data['labels'])
                /*function to generate random rgb colors*/
                function rgbColors() {
                const r = Math.floor(Math.random() * 255);
                const g = Math.floor(Math.random() * 255);
                const b = Math.floor(Math.random() * 255);
                return "rgb("+r.toString() + ", " + g.toString() + ", " + b.toString() + ")";
                }
                /* function to generate list of rgbColors()*/
                function colorsList(arg) {
                    const lst = [];
                    for(i = 0; i < arg.length; i++) {
                        lst.push(rgbColors());
                    }
                    return lst;
                }
                console.log(data['amounts'])
                new Chart(document.getElementById("bar-chart"), {
                    type: 'horizontalBar',
                    data: {
                    labels: data['labels'],
                    datasets: [
                        {
                            label: "Amount Spent ($)",
                            backgroundColor: colorsList(data['labels']),
                            data: data['amounts']
                        }
                    ]
                    },
                    options: {
                        tooltips:{
                            intersect : false,
                            mode:'index'
                        },
                        legend: { display: false },
                        title: {
                            display: false,
                            text: "Prince George's County Spending by Payment"
                        },
                        scales: {
                            xAxes: [{
                                scaleLabel: {
                                    display: true,
                                    labelString: "Amount ($)"
                                },
                                ticks: {
                                    min: 0
                                }
                            }]
                        }
                    }
                });
            })
        </script>
    </body>
</html>